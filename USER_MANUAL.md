# ともどこ（友達どこにいる？）ユーザーマニュアル

リベ大お金の勉強フェス2025での友達の位置を追跡・共有するWebアプリケーションです。

## 目次
1. [アプリの概要](#アプリの概要)
2. [初回セットアップ](#初回セットアップ)
3. [基本的な使い方](#基本的な使い方)
4. [地図の操作方法](#地図の操作方法)
5. [位置の登録・編集・削除](#位置の登録編集削除)
6. [フィルター機能](#フィルター機能)
7. [予定地管理](#予定地管理)
8. [プロフィール設定](#プロフィール設定)
9. [トラブルシューティング](#トラブルシューティング)
10. [技術仕様](#技術仕様)

---

## アプリの概要

### 主な機能
- **リアルタイム位置共有**: フェス会場での現在地や予定地を地図上で共有
- **時間軸対応**: 「現在地」と「予定地」の2つのモードで時間を考慮した位置管理
- **アバター表示**: 各ユーザーのプロフィール画像が地図上のマーカーに表示
- **モバイル最適化**: スマートフォンでの操作を前提とした設計
- **リベシティ連携**: リベシティでの活動名を表示可能

### 対応デバイス
- **スマートフォン（推奨）**: iOS Safari, Android Chrome
- **PC・タブレット**: Chrome, Firefox, Safari, Edge

---

## 初回セットアップ

### 1. アクセス方法
1. ブラウザで `https://harukaze1216.github.io/friend-location-tracker/` にアクセス
2. トップページが表示されます

### 2. ログイン
1. 「Googleでログイン」ボタンをクリック
2. Googleアカウントを選択してログイン
3. 初回ログイン時は自動的にプロフィール設定画面が開きます

### 3. プロフィール設定（初回必須）
1. **表示名**: フェスで表示される名前を入力（必須）
2. **アバター画像**: プロフィール写真をアップロード（任意）
   - 対応形式: JPEG, PNG, WebP
   - 推奨サイズ: 正方形、512x512px以下
3. **リベシティでの活動名**: リベシティでの名前を入力（任意）
4. 「プロフィールを作成」ボタンで完了

---

## 基本的な使い方

### 画面構成
1. **ヘッダー**: アプリ名、ログアウトボタン
2. **プロフィール表示**: 自分のアバターと名前、予定一覧・編集ボタン
3. **フィルター**: 表示する位置情報の絞り込み
4. **地図**: フェス会場マップと位置マーカー
5. **位置情報リスト**: 登録された位置の一覧

### 基本操作の流れ
1. 地図上で自分がいる/いく予定の場所をタップまたは長押し
2. 位置登録フォームで詳細を入力
3. 他のユーザーの位置を地図やフィルターで確認
4. 必要に応じて自分の位置を更新・削除

---

## 地図の操作方法

### 2つの操作モード

#### 🗺️ 地図移動モード（デフォルト）
- **目的**: 地図の閲覧とナビゲーション
- **操作方法**:
  - **スマホ**: 指でスワイプして地図移動、ピンチで拡大縮小
  - **PC**: マウスドラッグで地図移動、スクロールで拡大縮小
- **位置登録**: 
  - **スマホ**: 500ms長押しで位置登録フォーム表示
  - **PC**: クリックで位置登録フォーム表示

#### 📍 位置操作モード
- **目的**: 位置の登録とマーカーの移動
- **操作方法**:
  - タップ/クリックで即座に位置登録フォーム表示
  - 自分のマーカーをドラッグして位置変更
- **注意**: 地図の移動は無効になります

### モード切り替え
地図上部の「🗺️ 地図移動」「📍 位置操作」ボタンで切り替え可能

### 拡大縮小
- **拡大/縮小ボタン**: 地図上部右側
- **スケール表示**: 現在の拡大率（50%〜200%）
- **初期値**: スマホ70%、PC100%

---

## 位置の登録・編集・削除

### 新規位置登録

#### 手順
1. 地図上の目的の場所をタップ（長押し）
2. 位置登録フォームで以下を入力:

#### 位置の種類（必須）
- **📍 現在地**: 今いる場所
  - 選択すると現在時刻が自動設定
  - 終了時間は不要
- **📅 予定地**: これから行く予定の場所
  - 開始時間と終了時間の両方が必要

#### 日付（必須）
- **選択肢**: 
  - 8月9日(土) - Day 1
  - 8月10日(日) - Day 2  
  - 8月11日(月) - Day 3

#### 時間設定（必須）
- **現在地の場合**: 現在時間（自動設定、手動変更可能）
- **予定地の場合**: 開始時間と終了時間
- **現在時刻ボタン**: 現在時刻を自動入力

#### オプション項目
- **場所**: 具体的な場所名（例：メインステージ、フードコート）
- **コメント**: 追加情報（最大200文字）

### 位置の編集

#### マーカーから編集
1. 自分のマーカー（青い枠付き）をクリック
2. 詳細モーダルで「編集」をクリック
3. フォームで情報を変更して「更新」

#### ドラッグで位置変更
1. 「📍 位置操作モード」に切り替え
2. 自分のマーカーをドラッグして移動
3. 自動的に位置が更新されます

### 位置の削除
1. 自分のマーカーをクリック
2. 詳細モーダルまたは編集フォームで「削除」
3. 確認ダイアログで削除を実行

---

## フィルター機能

### クイックフィルター（常時表示）
- **📅 自分の予定**: 自分の予定地のみ表示
- **📍 現在地一覧**: 全ユーザーの現在地のみ表示
- **📅 今日**: 今日の位置情報のみ表示
- **クリア**: 全フィルターを解除

### 詳細フィルター（折りたたみ可能）
展開アイコンをクリックして表示：

#### 位置タイプ
- すべて表示
- 📍 現在地のみ
- 📅 予定地のみ

#### 日付で絞り込み
- すべての日付
- 8/9, 8/10, 8/11から選択

#### 時間で絞り込み
- すべての時間
- 登録されている時間から選択

#### ユーザーで絞り込み
- すべてのユーザー
- 特定のユーザーのみ

---

## 予定地管理

### 予定一覧の確認
1. プロフィール右側の「📅 予定一覧」をクリック
2. 自分の全予定地がリスト表示されます
3. 件数バッジで予定数を確認可能

### 予定地の特徴
- **地図上の表示**: マーカーの右側に小さなカード形式で表示
- **カード内容**: アバター、時間、終了時間
- **クリック操作**: カードクリックで詳細モーダル表示

### 予定地の管理
- **編集**: 詳細モーダルから編集フォームへ
- **削除**: 詳細モーダルまたは予定一覧から削除
- **時間表示**: 過去の予定は薄く表示

---

## プロフィール設定

### プロフィール編集
1. プロフィール右下の「編集」をクリック
2. 以下の項目を変更可能:
   - 表示名
   - アバター画像
   - リベシティでの活動名

### アバター画像のアップロード
1. 「ファイルを選択」で画像を選択
2. プレビューで確認
3. 「保存」で更新
4. 地図上のマーカーに即座に反映

### プロフィール表示
- **ヘッダー**: アバター、表示名、リベシティ名
- **地図マーカー**: 円形アバター表示
- **位置情報**: ツールチップやモーダルで名前表示

---

## トラブルシューティング

### よくある問題と解決方法

#### 地図が表示されない
- **原因**: ネットワーク接続やブラウザの問題
- **解決方法**: 
  1. ページを再読み込み
  2. ブラウザキャッシュをクリア
  3. 別のブラウザで試行

#### 位置登録できない
- **確認事項**:
  1. ログイン状態を確認
  2. プロフィールが完成しているか確認
  3. 必須項目（位置の種類、日付、時間）が入力されているか確認
  4. 適切な操作モードになっているか確認

#### マーカーをドラッグできない
- **原因**: 地図移動モードになっている
- **解決方法**: 「📍 位置操作モード」に切り替え

#### 他のユーザーが表示されない
- **確認事項**:
  1. フィルター設定を確認
  2. 該当する日付・時間に位置登録があるか確認
  3. ページを再読み込み

#### アバター画像がアップロードできない
- **確認事項**:
  1. ファイル形式（JPEG, PNG, WebP）
  2. ファイルサイズ（5MB以下推奨）
  3. ネットワーク接続状況

### パフォーマンス最適化

#### スマートフォンでの快適な利用
- **推奨ブラウザ**: 最新版のSafari（iOS）、Chrome（Android）
- **ネットワーク**: 4G以上の安定した接続
- **メモリ**: 他のアプリを閉じてメモリを確保

#### 大人数での利用時
- **表示人数**: 50人程度まで快適に動作
- **更新頻度**: リアルタイム更新でデータ同期
- **フィルター活用**: 必要な情報のみ表示して負荷軽減

---

## 技術仕様

### システム構成
- **フロントエンド**: React 18 + TypeScript
- **バックエンド**: Firebase (Firestore, Authentication, Storage)
- **デプロイ**: GitHub Pages
- **地図**: PNG画像ベース

### データ構造

#### ユーザープロフィール
```typescript
{
  uid: string;           // Firebase UID
  displayName: string;   // 表示名
  avatarUrl?: string;    // アバター画像URL
  libeCityName?: string; // リベシティ名
  profileCompleted: boolean; // プロフィール完成フラグ
  createdAt: Date;       // 作成日時
  updatedAt: Date;       // 更新日時
}
```

#### 位置情報
```typescript
{
  id: string;           // 位置情報ID
  userId: string;       // ユーザーID
  x: number;           // X座標
  y: number;           // Y座標
  date: string;        // 日付 (YYYY-MM-DD)
  time: string;        // 時間 (HH:mm)
  endTime?: string;    // 終了時間 (予定地の場合)
  locationType: 'current' | 'scheduled'; // 位置タイプ
  location?: string;   // 場所名
  comment?: string;    // コメント
  isActive: boolean;   // アクティブ状態
  createdAt: Date;     // 作成日時
  updatedAt: Date;     // 更新日時
}
```

### セキュリティ
- **認証**: Firebase Authentication (Google OAuth)
- **アクセス制御**: Firestore Security Rules
- **データ保護**: HTTPS通信、個人情報の最小限収集

### パフォーマンス
- **リアルタイム同期**: Firestore onSnapshot
- **画像最適化**: WebP対応、適切なサイズ変換
- **キャッシュ**: ブラウザキャッシュ活用

---

## サポート情報

### 更新履歴
アプリは継続的に改善されています。最新の機能については GitHub リポジトリをご確認ください。

### フィードバック
不具合報告や機能要望は、GitHub Issues または開発者までお知らせください。

### ライセンス
このアプリはMITライセンスの下で提供されています。

---

**ともどこ** - リベ大フェスで友達との時間をもっと楽しく！